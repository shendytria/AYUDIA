<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - AYUDIA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="stylesheet" href="css/admin.css">
</head>

<body class="bg-gray-100 font-sans">
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar fixed inset-y-0 left-0 w-64 text-white p-4 md:transform-none z-50 bg-[#2B2B2B]">
        <div class="flex items-center justify-between mb-8">
            <div class="flex items-center">
                <i class="fas fa-shopping-bag text-2xl text-white mr-2"></i>
                <h2 class="text-xl font-bold">AYUDIA</h2>
            </div>
            <button id="close-sidebar" class="md:hidden text-white hover:text-gray-300 transition-colors">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="mb-6">
            <div class="flex items-center mb-4">
                <img id="sidebar-profile-image" src="https://cdn-icons-png.flaticon.com/512/9703/9703596.png"
                    alt="Admin" class="w-10 h-10 rounded-full mr-3">
                <div>
                    <p id="sidebar-profile-name" class="font-medium">Admin AYUDIA</p>
                    <p class="text-xs text-gray-400">Admin</p>
                </div>
            </div>
        </div>

        <nav>
            <p class="text-xs uppercase font-semibold mb-4 pl-2 text-gray-400">Menu Utama</p>
            <ul>
                <li class="mb-2">
                    <a href="dashboard.html" data-page="dashboard"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200 active">
                        <i class="fas fa-tachometer-alt w-6 mr-3"></i> Dashboard
                    </a>
                </li>
                <li class="mb-2">
                    <a href="artikeladm.html" data-page="articles"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-newspaper w-6 mr-3"></i> Kelola Artikel
                    </a>
                </li>
                <li class="mb-2">
                    <a href="produk.html" data-page="products"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-box w-6 mr-3"></i> Kelola Produk
                    </a>
                </li>
                <li class="mb-2">
                    <a href="pengguna.html" data-page="users"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-users w-6 mr-3"></i> Kelola Pengguna
                    </a>
                </li>
                <li class="mb-2">
                    <a href="transaksi.html" data-page="transactions"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-money-bill-wave w-6 mr-3"></i> Kelola Transaksi
                    </a>
                </li>
            </ul>

            <p class="text-xs uppercase font-semibold mb-4 pl-2 mt-8 text-gray-400">Pengaturan</p>
            <ul>
                <li class="mb-2">
                    <a href="pengaturan.html" data-page="settings"
                        class="page-link sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-cog w-6 mr-3"></i> Pengaturan
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#" id="logout-btn"
                        class="sidebar-link flex items-center p-3 rounded-lg hover:bg-[#9B7E46] hover:text-white transition-all duration-200">
                        <i class="fas fa-sign-out-alt w-6 mr-3"></i> Logout
                    </a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="md:ml-64 p-6 min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-lg rounded-xl mb-6 p-4 glass-effect">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <button id="toggle-sidebar"
                        class="md:hidden text-gray-800 mr-4 hover:text-[#9B7E46] transition-colors">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <h1 id="page-title" class="text-2xl font-bold text-gray-800">Dashboard</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="text-gray-500 hover:text-gray-800 focus:outline-none transition-colors"
                            id="notification-btn">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="badge" id="notification-badge">3</span>
                        </button>
                    </div>
                    <div class="relative">
                        <button id="user-menu-btn"
                            class="flex items-center hover:bg-gray-50 p-2 rounded-lg transition-all duration-200">
                            <img id="header-profile-image" src="https://cdn-icons-png.flaticon.com/512/9703/9703596.png"
                                alt="Admin" class="w-10 h-10 rounded-full mr-2">
                            <span id="header-profile-name" class="hidden md:block font-medium">Admin AYUDIA</span>
                            <i class="fas fa-chevron-down ml-2 text-gray-400"></i>
                        </button>
                        <div id="user-dropdown"
                            class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 z-[9999] border">
                            <a href="profil.html"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors">Profil</a>
                            <a href="pengaturan.html"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors">Pengaturan</a>
                            <div class="border-t border-gray-100"></div>
                            <a href="#" id="dropdown-logout"
                                class="block px-4 py-2 text-sm text-red-500 hover:bg-gray-100 transition-colors">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Content -->
        <div id="content">
            <!-- Summary Cards -->
            <div class="mb-8">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="stats-card rounded-xl shadow-lg p-6 flex items-center card-hover fade-in">
                        <div class="rounded-full bg-gradient-to-r from-blue-400 to-blue-600 p-4 mr-4">
                            <i class="fas fa-newspaper text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-500 text-sm font-medium">Artikel</p>
                            <h3 id="article-count" class="text-3xl font-bold text-gray-800">0</h3>
                            <div class="flex items-center mt-1">
                                <i class="fas fa-arrow-up text-green-500 text-xs mr-1"></i>
                                <span class="text-green-500 text-sm font-medium">+12%</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl shadow-lg p-6 flex items-center card-hover fade-in"
                        style="animation-delay: 0.1s">
                        <div class="rounded-full bg-gradient-to-r from-green-400 to-green-600 p-4 mr-4">
                            <i class="fas fa-box text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-500 text-sm font-medium">Produk</p>
                            <h3 id="product-count" class="text-3xl font-bold text-gray-800">0</h3>
                            <div class="flex items-center mt-1">
                                <i class="fas fa-arrow-up text-green-500 text-xs mr-1"></i>
                                <span class="text-green-500 text-sm font-medium">+8%</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl shadow-lg p-6 flex items-center card-hover fade-in"
                        style="animation-delay: 0.2s">
                        <div class="rounded-full bg-gradient-to-r from-yellow-400 to-yellow-600 p-4 mr-4">
                            <i class="fas fa-users text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-500 text-sm font-medium">Pengguna</p>
                            <h3 id="user-count" class="text-3xl font-bold text-gray-800">0</h3>
                            <div class="flex items-center mt-1">
                                <i class="fas fa-arrow-up text-green-500 text-xs mr-1"></i>
                                <span class="text-green-500 text-sm font-medium">+23%</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl shadow-lg p-6 flex items-center card-hover fade-in"
                        style="animation-delay: 0.3s">
                        <div class="rounded-full bg-gradient-to-r from-red-400 to-red-600 p-4 mr-4">
                            <i class="fas fa-money-bill-wave text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-500 text-sm font-medium">Transaksi</p>
                            <h3 id="transaction-count" class="text-3xl font-bold text-gray-800">0</h3>
                            <div class="flex items-center mt-1">
                                <i class="fas fa-arrow-up text-green-500 text-xs mr-1"></i>
                                <span class="text-green-500 text-sm font-medium">+15%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <!-- Revenue Chart -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 0.4s">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-semibold text-gray-600 flex items-center">
                            <i class="fas fa-chart-line text-[#9B7E46] mr-2"></i>
                            Ringkasan Pendapatan
                        </h2>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-600">Total:</span>
                            <span class="total-revenue text-lg font-semibold text-[#9B7E46]" id="total-revenue">Rp
                                0</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Category Distribution -->
                <div class="bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 0.5s">
                    <h2 class="text-lg font-semibold mb-4 text-gray-900 flex items-center">
                        <i class="fas fa-chart-pie text-[#9B7E46] mr-2"></i>
                        Distribusi Kategori
                    </h2>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Performance Metrics -->
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
                <div class="metric-card bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 0.6s">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-medium text-gray-600">Penjualan Hari Ini</h3>
                        <i class="fas fa-shopping-cart text-[#9B7E46]"></i>
                    </div>
                    <p class="text-2xl font-bold text-gray-800">Rp 2.4M</p>
                    <div class="progress-bar mt-2">
                        <div class="progress-fill w-3/4"></div>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">75% dari target</p>
                </div>
                <div class="metric-card bg-white rounded-xl p-6 fade-in" style="animation-delay: 0.7s">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-medium text-gray-600">Pengunjung Aktif</h3>
                        <i class="fas fa-eye text-[#9B7E46]"></i>
                    </div>
                    <p class="text-2xl font-bold text-gray-800">1,234</p>
                    <div class="progress-bar mt-2">
                        <div class="progress-fill w-3/5"></div>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">+18% dari kemarin</p>
                </div>
                <div class="metric-card bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 0.8s">
                    <div class="flex justify-between mb-2 items-center">
                        <h3 class="text-sm font-medium text-gray-600">Konversi</h3>
                        <i class="fas fa-percentage text-[#9B7E46]"></i>
                    </div>
                    <p class="text-2xl font-bold text-gray-800">3.2%</p>
                    <div class="progress-bar mt-2">
                        <div class="progress-fill w-4/5"></div>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">Rate konversi</p>
                </div>
                <div class="metric-card bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 0.9s">
                    <div class="flex items-center mb-2 justify-between">
                        <h3 class="text-sm font-medium text-gray-600">Rata-rata Order</h3>
                        <i class="fas fa-calculator text-[#9B7E46]"></i>
                    </div>
                    <p class="text-2xl font-bold text-gray-800">Rp 850K</p>
                    <div class="progress-bar mt-2">
                        <div class="progress-fill w-17/20"></div>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">Per transaksi</p>
                </div>
            </div>

            <!-- Activity & Recent Orders -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Recent Activity -->
                <div class="bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 1.0s;">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-clock text-[#9B7E46] mr-2"></i>
                            Aktivitas Terbaru
                        </h2>
                        <a href="#" class="text-[#9B7E46] text-sm hover:underline transition-colors">Lihat Semua</a>
                    </div>
                    <div id="activity-list" class="space-y-3"></div>
                </div>

                <!-- Recent Orders -->
                <div class="bg-white shadow-lg rounded-xl p-6 fade-in" style="animation-delay: 1.1s">
                    <div class="flex items-center mb-4 justify-between">
                        <h2 class="text-lg font-semibold text-[#9B7E46] flex items-center">
                            <i class="fas fa-shopping-cart text-[#9B7E46] mr-2"></i>
                            Transaksi Terbaru
                        </h2>
                        <a href="transaksi.html" class="text-[#9B7E46] text-sm hover:underline transition-colors">Lihat
                            Semua</a>
                    </div>
                    <div class="space-y-3" id="recent-orders"></div>
                </div>
            </div>

            <!-- Popular Products -->
            <div class="mt-6 bg-white rounded-xl shadow-lg p-6 fade-in" style="animation-delay: 1.2s;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-star text-[#9B7E46] mr-2"></i>
                        Produk Populer
                    </h2>
                    <a href="produk.html" class="text-[#9B7E46] text-sm hover:underline transition-colors">Lihat
                        Semua</a>
                </div>
                <div id="popular-products" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
            </div>
        </div>

        <!-- Notification Panel -->
        <div id="notification-panel" class="fixed inset-0 notification-panel hidden z-50">
            <div id="notification-sidebar"
                class="absolute right-0 top-0 h-full w-80 bg-white shadow-2xl transform transition-transform duration-300 translate-x-full">
                <div class="p-4 border-b flex justify-between items-center bg-[#9B7E46] text-white">
                    <h3 class="font-medium">Notifikasi</h3>
                    <button id="close-notification" type="button"
                        class="text-white hover:text-gray-200 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-4">
                    <div class="mb-4 pb-4 border-b activity-item">
                        <div class="flex items-center mb-2">
                            <div class="rounded-full bg-blue-100 p-2 mr-3">
                                <i class="fas fa-user-plus text-blue-500"></i>
                            </div>
                            <p class="font-medium">Pengguna Baru</p>
                            <div class="notification-dot ml-auto"></div>
                        </div>
                        <p class="text-gray-600 text-sm">Ifa telah mendaftar sebagai pengguna baru.</p>
                        <p class="text-gray-400 text-xs mt-1">10 menit yang lalu</p>
                    </div>
                    <div class="mb-4 pb-4 border-b activity-item">
                        <div class="flex items-center mb-2">
                            <div class="rounded-full bg-green-100 p-2 mr-3">
                                <i class="fas fa-shopping-cart text-green-500"></i>
                            </div>
                            <p class="font-medium">Transaksi Baru</p>
                            <div class="notification-dot ml-auto"></div>
                        </div>
                        <p class="text-gray-600 text-sm">Transaksi baru dari Dinda senilai Rp 1,750,000.</p>
                        <p class="text-gray-400 text-xs mt-1">30 menit yang lalu</p>
                    </div>
                    <div class="mb-4 activity-item">
                        <div class="flex items-center mb-2">
                            <div class="rounded-full bg-red-100 p-2 mr-3">
                                <i class="fas fa-exclamation-circle text-red-500"></i>
                            </div>
                            <p class="font-medium">Stok Menipis</p>
                        </div>
                        <p class="text-gray-600 text-sm">Produk "Kebaya Rona Hijau" hampir habis (sisa 2).</p>
                        <p class="text-gray-400 text-xs mt-1">2 jam yang lalu</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logout Confirmation Modal -->
        <div id="logout-modal"
            class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl w-96 p-6 shadow-2xl">
                <h3 class="text-lg font-medium mb-4 text-gray-800">Konfirmasi Logout</h3>
                <p class="text-gray-600 mb-6">Apakah Anda yakin ingin keluar dari dashboard admin?</p>
                <div class="flex justify-end space-x-3">
                    <button id="cancel-logout"
                        class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-lg transition-colors">Batal</button>
                    <button id="confirm-logout"
                        class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg transition-colors">Ya,
                        Logout</button>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                // Sidebar Toggle
                const toggleSidebar = document.getElementById('toggle-sidebar');
                const closeSidebar = document.getElementById('close-sidebar');
                const sidebar = document.getElementById('sidebar');

                if (toggleSidebar) {
                    toggleSidebar.addEventListener('click', () => {
                        sidebar.classList.toggle('active');
                    });
                }
                if (closeSidebar) {
                    closeSidebar.addEventListener('click', () => {
                        sidebar.classList.remove('active');
                    });
                }

                // User Dropdown
                const userMenuBtn = document.getElementById('user-menu-btn');
                const userDropdown = document.getElementById('user-dropdown');
                if (userMenuBtn && userDropdown) {
                    userMenuBtn.addEventListener('click', () => {
                        userDropdown.classList.toggle('hidden');
                    });
                    userDropdown.addEventListener('click', (e) => {
                        if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
                            userMenuBtn.classList.add('hidden');
                        }
                    });
                }

                // Notification Panel
                const notificationBtn = document.getElementById('notification-btn');
                const notificationPanel = document.getElementById('notification-panel');
                const notificationSidebar = document.getElementById('notification-sidebar');
                const closeNotification = document.getElementById('close-notification');

                if (notificationBtn && notificationPanel && notificationSidebar && closeNotification) {
                    notificationBtn.addEventListener('click', () => {
                        notificationPanel.classList.remove('hidden');
                        setTimeout(() => {
                            notificationSidebar.classList.remove('translate-x-full');
                        }, 10);
                    });

                    closeNotification.addEventListener('click', () => {
                        notificationSidebar.classList.add('translate-x-full');
                        setTimeout(() => {
                            notificationPanel.classList.add('hidden');
                        }, 300);
                    });

                    notificationPanel.addEventListener('click', (e) => {
                        if (e.target === notificationPanel) {
                            notificationSidebar.classList.add('translate-x-full');
                            setTimeout(() => {
                                notificationPanel.classList.add('hidden');
                            }, 300);
                        }
                    });
                }

                // Logout Modal
                const logoutBtn = document.getElementById('logout-btn');
                const dropdownLogout = document.getElementById('dropdown-logout');
                const logoutModal = document.getElementById('logout-modal');
                const cancelLogout = document.getElementById('cancel-logout');
                const confirmLogout = document.getElementById('confirm-logout');

                if (logoutBtn && logoutModal && cancelLogout && confirmLogout) {
                    logoutBtn.addEventListener('click', () => {
                        logoutModal.classList.remove('hidden');
                    });
                    if (dropdownLogout) {
                        dropdownLogout.addEventListener('click', () => {
                            logoutModal.classList.remove('hidden');
                        });
                    }
                    cancelLogout.addEventListener('click', () => {
                        logoutModal.classList.add('hidden');
                    });
                    confirmLogout.addEventListener('click', () => {
                        showNotification('Anda berhasil logout!');
                        setTimeout(() => {
                            window.location.href = 'index.html';
                        }, 1000);
                    });
                    logoutModal.addEventListener('click', (e) => {
                        if (e.target === logoutModal) {
                            logoutModal.classList.add('hidden');
                        }
                    });
                }

                // Notification Helper
                function showNotification(message) {
                    const tempDiv = document.createElement('div');
                    tempDiv.className = 'fixed bottom-4 right-4 bg-[#9B7E46] text-white px-6 py-3 rounded-lg shadow-lg';
                    tempDiv.textContent = message;
                    document.body.appendChild(tempDiv);
                    setTimeout(() => tempDiv.remove(), 3000);
                }

                // Format Date
                function formatDate(isoString) {
                    try {
                        const date = new Date(isoString);
                        if (isNaN(date.getTime())) return 'Baru saja';
                        return date.toLocaleString('id-ID', {
                            day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'
                        });
                    } catch {
                        return 'Baru saja';
                    }
                }

                // Data Initialization (Dummy Data)
                let articles = JSON.parse(localStorage.getItem('articles')) || [
                    { id: 1, title: 'Keindahan Batik Nusantara', content: '<p>Batik adalah warisan budaya...</p>', category: 'berita', image: '' },
                    { id: 2, title: 'Tutorial Membuat Kebaya', content: '<p>Langkah-langkah membuat kebaya...</p>', category: 'tutorial', image: '' }
                ];
                let products = JSON.parse(localStorage.getItem('products')) || [
                    { id: 1, name: 'Kebaya Pink Bordir Mawar', description: 'Kebaya warna pink lembut dengan detail bordir bunga mawar di bagian lengan dan kerah, memberikan kesan feminin dan elegan.', sizes: ['S', 'M', 'L', 'XL'], category: 'kebaya_kutubaru', price: 875000, image: 'https://dynamic.zacdn.com/dfDKfU4zE6y0qph0s92V15Adzzo=/filters:quality(70):format(webp)/https://static-id.zacdn.com/p/maslea-5885-2210264-1.jpg' },
                    { id: 2, name: 'Kebaya Brokat Putih Lengan Pendek', description: 'Kebaya brokat transparan lengan pendek dengan motif bunga besar kontras, cocok untuk gaya kasual etnik yang chic.', sizes: ['XS', 'S', 'M', 'L', 'XL'], category: 'kebaya_encim', price: 695000, image: 'https://i.pinimg.com/736x/29/83/03/2983036f793885b33421cb13ad672cd2.jpg' },
                ];
                let users = JSON.parse(localStorage.getItem('users')) || [
                    { id: 1, name: 'Amel', email: 'amel@gmail.com', role: 'user' },
                    { id: 2, name: 'Tria', email: 'tria@gmail.com', role: 'user' },
                    { id: 3, name: 'Fara', email: 'fara@gmail.com', role: 'user' },
                    { id: 4, name: 'Ifa', email: 'ifa@gmail.com', role: 'user' }
                ];
                let transactions = JSON.parse(localStorage.getItem('transactions')) || [
                    { id: 1, userId: 1, productId: 1, date: '2025-05-10T14:30:00Z', total: 695000, status: 'Berhasil' },
                    { id: 2, userId: 2, productId: 2, date: '2025-05-15T09:15:00Z', total: 1750000, status: 'Menunggu' }
                ];
                let adminProfile = JSON.parse(localStorage.getItem('adminProfile')) || {
                    name: 'Admin AYUDIA',
                    email: 'admin@ayudia.com',
                    password: 'admin123',
                    image: 'https://cdn-icons-png.flaticon.com/512/9703/9703596.png'
                };

                // Update Profile
                function updateProfileDisplay() {
                    const sidebarName = document.getElementById('sidebar-profile-name');
                    const headerName = document.getElementById('header-profile-name');
                    const sidebarImage = document.getElementById('sidebar-profile-image');
                    const headerImage = document.getElementById('header-profile-image');
                    if (sidebarName) sidebarName.textContent = adminProfile.name;
                    if (headerName) headerName.textContent = adminProfile.name;
                    if (sidebarImage) sidebarImage.src = adminProfile.image || 'https://via.placeholder.com/40';
                    if (headerImage) headerImage.src = adminProfile.image || 'https://via.placeholder.com/40';
                }

                // Update Notifications
                function updateNotifications() {
                    const notificationList = document.getElementById('notification-list');
                    if (!notificationList) return;
                    notificationList.innerHTML = '';
                    const notifications = [
                        ...transactions.map(t => ({
                            title: 'Transaksi Baru',
                            message: `Transaksi #${t.id} senilai Rp ${t.total.toLocaleString('id-ID')}.`,
                            time: formatDate(t.date),
                            icon: 'fas fa-shopping-cart',
                            color: 'bg-green-100 text-green-500'
                        })),
                        ...users.slice(0, 2).map(u => ({
                            title: 'Pengguna Baru',
                            message: `${u.name} mendaftar sebagai pengguna baru.`,
                            time: 'Baru saja',
                            icon: 'fas fa-user-plus',
                            color: 'bg-blue-100 text-blue-500'
                        }))
                    ].slice(0, 3);
                    notifications.forEach(n => {
                        const item = document.createElement('div');
                        item.className = 'mb-4 pb-4 border-b';
                        item.innerHTML = `
                <div class="flex items-center mb-2">
                    <div class="rounded-full ${n.color} p-2 mr-3">
                        <i class="${n.icon}"></i>
                    </div>
                    <p class="font-medium">${n.title}</p>
                    <div class="notification-dot ml-auto"></div>
                </div>
                <p class="text-gray-600 text-sm">${n.message}</p>
                <p class="text-gray-400 text-xs mt-1">${n.time}</p>
            `;
                        notificationList.appendChild(item);
                    });
                    const badge = document.getElementById('notification-badge');
                    if (badge) badge.textContent = notifications.length;
                }

                // Dashboard Update
                let revenueChart = null;
                let categoryChart = null;

                function updateDashboard() {
                    // Validate Data
                    articles = Array.isArray(articles) ? articles : [];
                    products = Array.isArray(products) ? products : [];
                    users = Array.isArray(users) ? users : [];
                    transactions = Array.isArray(transactions) ? transactions : [];

                    // Summary Cards
                    const articleCount = document.getElementById('article-count');
                    const productCount = document.getElementById('product-count');
                    const userCount = document.getElementById('user-count');
                    const transactionCount = document.getElementById('transaction-count');
                    if (articleCount) articleCount.textContent = articles.length;
                    if (productCount) productCount.textContent = products.length;
                    if (userCount) userCount.textContent = users.length;
                    if (transactionCount) transactionCount.textContent = transactions.length;

                    // Performance Metrics
                    const today = new Date().toISOString().split('T')[0];
                    const dailySales = transactions
                        .filter(t => t.date.startsWith(today))
                        .reduce((sum, t) => sum + t.total, 0);
                    const dailySalesEl = document.getElementById('daily-sales');
                    const dailySalesProgress = document.getElementById('daily-sales-progress');
                    if (dailySalesEl) dailySalesEl.textContent = `Rp ${dailySales.toLocaleString('id-ID')}`;
                    if (dailySalesProgress) dailySalesProgress.style.width = `${(dailySales / 5000000) * 100}%`;

                    const activeVisitors = Math.floor(Math.random() * 500) + 1000;
                    const activeVisitorsEl = document.getElementById('active-visitors');
                    const activeVisitorsProgress = document.getElementById('active-visitors-progress');
                    if (activeVisitorsEl) activeVisitorsEl.textContent = activeVisitors.toLocaleString('id-ID');
                    if (activeVisitorsProgress) activeVisitorsProgress.style.width = `${(activeVisitors / 2000) * 100}%`;

                    const conversionRate = transactions.length ? ((transactions.length / activeVisitors) * 100).toFixed(1) : 0;
                    const conversionRateEl = document.getElementById('conversion-rate');
                    const conversionRateProgress = document.getElementById('conversion-rate-progress');
                    if (conversionRateEl) conversionRateEl.textContent = `${conversionRate}%`;
                    if (conversionRateProgress) conversionRateProgress.style.width = `${conversionRate * 10}%`;

                    const averageOrder = transactions.length ? (transactions.reduce((sum, t) => sum + t.total, 0) / transactions.length).toFixed(0) : 0;
                    const averageOrderEl = document.getElementById('average-order');
                    const averageOrderProgress = document.getElementById('average-order-progress');
                    if (averageOrderEl) averageOrderEl.textContent = `Rp ${parseInt(averageOrder).toLocaleString('id-ID')}`;
                    if (averageOrderProgress) averageOrderProgress.style.width = `${(averageOrder / 2000000) * 100}%`;

                    // Recent Orders
                    const recentOrders = document.getElementById('recent-orders');
                    if (recentOrders) {
                        recentOrders.innerHTML = '';
                        transactions
                            .sort((a, b) => new Date(b.date) - new Date(a.date))
                            .slice(0, 5)
                            .forEach(transaction => {
                                const user = users.find(u => u.id === transaction.userId) || { name: 'Tidak diketahui' };
                                const statusColor = transaction.status === 'Berhasil' ? 'bg-green-100 text-green-600' :
                                    transaction.status === 'Menunggu' ? 'bg-yellow-100 text-yellow-600' :
                                        'bg-red-100 text-red-600';
                                const item = document.createElement('div');
                                item.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100';
                                item.innerHTML = `
                        <div>
                            <p class="font-semibold text-sm text-gray-800">ID: #${transaction.id}</p>
                            <p class="text-gray-600 text-xs">${user.name}</p>
                            <p class="text-gray-500 text-xs">${formatDate(transaction.date)}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold text-sm">Rp ${transaction.total.toLocaleString('id-ID')}</p>
                            <span class="px-2 py-1 rounded-full text-xs ${statusColor}">${transaction.status}</span>
                        </div>
                    `;
                                recentOrders.appendChild(item);
                            });
                    }

                    // Popular Products
                    const popularProducts = document.getElementById('popular-products');
                    if (popularProducts) {
                        popularProducts.innerHTML = '';
                        const productSales = products.map(product => ({
                            ...product,
                            salesCount: transactions.filter(t => t.productId === product.id).length
                        }));
                        productSales
                            .sort((a, b) => b.salesCount - a.salesCount || b.price - a.price)
                            .slice(0, 2)
                            .forEach(product => {
                                const item = document.createElement('div');
                                item.className = 'flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100';
                                item.innerHTML = `
                        <img src="${product.image || 'https://via.placeholder.com/80'}" alt="${product.name}" class="w-20 h-20 rounded-lg mr-4 object-cover">
                        <div class="flex-1">
                            <p class="font-semibold text-gray-800">${product.name}</p>
                            <p class="text-gray-600 text-sm">${product.category.replace('kebaya_', '').charAt(0).toUpperCase() + product.category.replace('kebaya_', '').slice(1)}</p>
                            <p class="text-gray-600 text-sm mt-1">Rp ${product.price.toLocaleString('id-ID')}</p>
                        </div>
                    `;
                                popularProducts.appendChild(item);
                            });
                    }

                    // Activity
                    const activityList = document.getElementById('activity-list');
                    if (activityList) {
                        activityList.innerHTML = '';
                        const activities = [
                            ...transactions.map(t => ({
                                type: 'transaction',
                                message: `Transaksi baru #${t.id} senilai Rp ${t.total.toLocaleString('id-ID')}`,
                                time: formatDate(t.date),
                                icon: 'fas fa-shopping-cart',
                                color: 'bg-green-100 text-green-500'
                            })),
                            ...users.slice(0, 2).map(u => ({
                                type: 'user',
                                message: `${u.name} mendaftar sebagai pengguna baru`,
                                time: 'Baru saja',
                                icon: 'fas fa-user-plus',
                                color: 'bg-blue-100 text-blue-500'
                            })),
                            {
                                type: 'stock',
                                message: 'Stok Kebaya Encim tinggal 5 unit',
                                time: '1 jam yang lalu',
                                icon: 'fas fa-exclamation-circle',
                                color: 'bg-red-100 text-red-500'
                            }
                        ].sort((a, b) => {
                            const aTime = a.time === 'Baru saja' ? new Date() : new Date(a.time);
                            const bTime = b.time === 'Baru saja' ? new Date() : new Date(b.time);
                            return bTime - aTime;
                        }).slice(0, 4);
                        activities.forEach(activity => {
                            const item = document.createElement('div');
                            item.className = 'flex items-start p-3 rounded-lg hover:bg-gray-50';
                            item.innerHTML = `
                    <div class="rounded-full ${activity.color} p-2 mr-3 mt-1">
                        <i class="${activity.icon} text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-600 text-sm font-medium">${activity.message}</p>
                        <p class="text-gray-400 text-xs mt-1">${activity.time}</p>
                    </div>
                `;
                            activityList.appendChild(item);
                        });
                    }

                    // Revenue Chart (Dummy Data)
                    const ctxRevenue = document.getElementById('revenueChart');
                    if (ctxRevenue) {
                        if (revenueChart) {
                            try {
                                revenueChart.destroy();
                            } catch (e) {
                                console.warn('Failed to destroy revenueChart:', e);
                            }
                        }
                        const dummyRevenue = [
                            { month: 'Jan 2025', revenue: 3000000 },
                            { month: 'Feb 2025', revenue: 4500000 },
                            { month: 'Mar 2025', revenue: 5000000 },
                            { month: 'Apr 2025', revenue: 4000000 },
                            { month: 'Mei 2025', revenue: 2898900 } // Dari transactions
                        ];
                        const totalRevenue = dummyRevenue.reduce((sum, item) => sum + item.revenue, 0);
                        const totalRevenueEl = document.getElementById('total-revenue');
                        if (totalRevenueEl) totalRevenueEl.textContent = `Rp ${totalRevenue.toLocaleString('id-ID')}`;
                        try {
                            revenueChart = new Chart(ctxRevenue, {
                                type: 'line',
                                data: {
                                    labels: dummyRevenue.map(item => item.month),
                                    datasets: [{
                                        label: 'Pendapatan',
                                        data: dummyRevenue.map(item => item.revenue),
                                        borderColor: '#9B7E46',
                                        backgroundColor: 'rgba(155, 126, 70, 0.1)',
                                        tension: 0.4,
                                        fill: true
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    scales: {
                                        y: {
                                            beginAtZero: true,
                                            ticks: {
                                                callback: value => `Rp ${value.toLocaleString('id-ID')}`
                                            }
                                        }
                                    },
                                    plugins: {
                                        tooltip: {
                                            callbacks: {
                                                label: context => `Rp ${context.raw.toLocaleString('id-ID')}`
                                            }
                                        }
                                    }
                                }
                            });
                        } catch (e) {
                            console.error('Failed to create revenueChart:', e);
                        }
                    }

                    // Category Chart
                    const ctxCategory = document.getElementById('categoryChart');
                    if (ctxCategory) {
                        if (categoryChart) {
                            try {
                                categoryChart.destroy();
                            } catch (e) {
                                console.warn('Failed to destroy categoryChart:', e);
                            }
                        }
                        const categoryData = products.reduce((acc, product) => {
                            acc[product.category] = (acc[product.category] || 0) + 1;
                            return acc;
                        }, {});
                        try {
                            categoryChart = new Chart(ctxCategory, {
                                type: 'doughnut',
                                data: {
                                    labels: Object.keys(categoryData).map(label => label.replace('kebaya_', '').toUpperCase()),
                                    datasets: [{
                                        data: Object.values(categoryData),
                                        backgroundColor: ['#9B7E46', '#d4af37'],
                                        borderColor: '#ffffff',
                                        borderWidth: 2
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        legend: { position: 'bottom' }
                                    },
                                    cutout: '60%'
                                }
                            });
                        } catch (e) {
                            console.error('Failed to create categoryChart:', e);
                        }
                        const totalProductsEl = document.getElementById('total-products');
                        if (totalProductsEl) totalProductsEl.textContent = `Total: ${products.length} produk`;
                    }

                    updateNotifications();
                }

                // Real-time Update
                window.addEventListener('storage', (e) => {
                    if (['articles', 'products', 'users', 'transactions', 'adminProfile'].includes(e.key)) {
                        try {
                            articles = JSON.parse(localStorage.getItem('articles')) || articles;
                            products = JSON.parse(localStorage.getItem('products')) || products;
                            users = JSON.parse(localStorage.getItem('users')) || users;
                            transactions = JSON.parse(localStorage.getItem('transactions')) || transactions;
                            adminProfile = JSON.parse(localStorage.getItem('adminProfile')) || adminProfile;
                            updateProfileDisplay();
                            updateDashboard();
                        } catch (e) {
                            console.error('Failed to parse localStorage:', e);
                        }
                    }
                });

                // Initial Render
                try {
                    updateProfileDisplay();
                    updateDashboard();
                } catch (e) {
                    console.error('Initial dashboard render failed:', e);
                }
            });
        </script>
</body>

</html>